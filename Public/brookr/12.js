(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"/qA+":function(e,t,n){"use strict";n.r(t),t.default=""},pGcJ:function(e,t,n){"use strict";n.r(t),n.d(t,"LoadsModule",(function(){return j}));var o=n("LoAr"),a=n("WT9V"),r=n("981U"),i=n("AFHi"),s=n("qptw"),c=n("8YcR"),l=n("z35L"),d=n("75Dc"),u=n("+BR4"),p=n("jpeZ"),f=function(){return(f=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},h=function(e,t,n,o){var a,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(r<3?a(i):r>3?a(t,n,i):a(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e){return e&&e.__esModule?e:{default:e}},b=function(){function e(e,t,n,o){this.tendoo=e,this.snackbar=t,this.dialog=n,this.router=o,this.isLoading=!1,this.sort={},this.search={},this.page={},this.query={},this.bulkMenus=[],this.perPage={per_page:10},this.hasLoaded=!1}return e.prototype.loadConfiguration=function(){var e=this;!1===this.hasLoaded?(this.tendoo.crud.getConfig("brookr.loads",f(f(f(f(f({},this.page),this.search),this.sort),this.perPage),this.query)).subscribe((function(t){e.config=t})),this.hasLoaded=!0):this.tendoo.crud.getEntries("brookr.loads",f(f(f(f(f({},this.page),this.search),this.sort),this.perPage),this.query)).subscribe((function(t){e.config=f(f({},e.config),{results:t})}))},e.prototype.ngOnInit=function(){var e=this;this.loadConfiguration(),this.bulkMenus=[{label:"Delete Selected",onClick:function(t){if(0===t.length)return e.snackbar.open("Please select at least one element.","OK",{duration:3e3});e.dialog.open(i.b,{id:"confirm-dialog",data:{title:"Confirm your action",message:"Would you like to delete the selected loads.",buttons:[{namespace:"yes",label:"Yes",onClick:function(){e.dialog.getDialogById("confirm-dialog").close(),e.tendoo.crud.deleteBulkEntries("brookr.loads",t.map((function(e){return e.id}))).subscribe((function(t){e.snackbar.open(t.message,"OK",{duration:3e3}),e.loadConfiguration()}),(function(t){e.snackbar.open(t.error.message||t.message,"OK",{duration:3e3})}))}},{namespace:"no",label:"No",onClick:function(){e.dialog.getDialogById("confirm-dialog").close()}}]}})}}]},e.prototype.handlePageSize=function(e){this.perPage={per_page:e},this.loadConfiguration()},e.prototype.handleNavigation=function(e){this.page={page:e},this.ngOnInit()},e.prototype.handleAction=function(e){var t=this;"DELETE"===e.menu.type?this.tendoo.crud.delete(e.menu.url.replace("{id}",e.row.id)).subscribe((function(n){t.snackbar.open(n.message,"OK",{duration:3e3}),t.ngOnInit(),t.dialog.getDialogById(e.menu.namespace).close()}),(function(n){t.snackbar.open(n.error.message||"An unexpected error occured","OK",{duration:5e3}),t.dialog.getDialogById(e.menu.namespace).close()})):"GOTO"===e.menu.type?this.router.navigateByUrl(e.menu.url.replace("{id}",e.row.id)):"OPEN"===e.menu.type&&"open.assign_driver"===e.menu.namespace?this.openLoadAssignation(e.menu):"OPEN"===e.menu.type&&"open.change_status"===e.menu.namespace?this.openLoadChangeStatus(e.menu):["rate_document_url","delivery_document_url"].includes(e.menu.namespace)?this.tendoo.get(this.tendoo.baseUrl+"brookr/loads/"+e.row.id+"/assets/"+e.menu.namespace).subscribe((function(e){window.open(e.data.url)}),(function(e){t.snackbar.open(e.error.message||e.message,"OK",{duration:3e3})})):"open.load_history"===e.menu.namespace?this.tendoo.get(this.tendoo.baseUrl+"brookr/loads/"+e.row.id+"/history").subscribe((function(e){if(0===e.length)return t.snackbar.open("This load doesn't have any history.","OK",{duration:3e3});t.dialog.open(p.a,{id:"load-history",data:{history:e},width:[t.tendoo.responsive.isLG(),t.tendoo.responsive.isXL()].includes(!0)?"40%":"90%"})})):"notify_delivery"===e.menu.namespace&&this.dialog.open(i.b,{id:"notify-delivery",width:[this.tendoo.responsive.isLG(),this.tendoo.responsive.isMD(),this.tendoo.responsive.isXL()].includes(!0)?"30%":"90%",data:{title:"Notify the delivery",message:"Would you like to notify the delivery of the Load ? This means the Proof Of Delivery and the Rate Document will be emailed to the company you have assigned on the settings. Please confirm.",buttons:[{namespace:"yes",label:"Send",onClick:function(){t.tendoo.get(e.menu.url.replace("{id}",e.row.id)).subscribe((function(e){t.dialog.getDialogById("notify-delivery").close(),t.snackbar.open(e.message,"OK",{duration:3e3})}),(function(e){t.snackbar.open(e.error.message||e.message,"OK",{duration:6e3})}))}},{namespace:"no",label:"Cancel",onClick:function(){t.dialog.getDialogById("notify-delivery").close()}}]}})},e.prototype.openLoadChangeStatus=function(e){var t=this;console.log(e),this.dialog.open(u.a,{id:"load-status",data:e,height:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"80%":"400px",width:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"70%":"500px"}).afterClosed().subscribe((function(e){t.ngOnInit(),console.log(e)}))},e.prototype.openLoadAssignation=function(e){var t=this;this.dialog.open(d.a,{id:"assign-load",data:e,height:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"80%":"400px",width:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"70%":"500px"}).afterClosed().subscribe((function(e){t.ngOnInit(),console.log(e)}))},e.prototype.handleSort=function(e){this.sort=e,this.ngOnInit()},e.prototype.handleSearch=function(e){this.search={search:e},this.ngOnInit()},e.prototype.handleSearchStatus=function(e){!1===e&&(this.search={},this.ngOnInit())},e.prototype.handleRefresh=function(e){this.ngOnInit()},e.prototype.handleCloseSearch=function(){this.query={}},e.prototype.handlePagineNavigation=function(e){this.perPage={per_page:e.pageSize},this.page={page:e.pageIndex+1},this.ngOnInit()},e.prototype.handleQuerySearch=function(e){this.search={},this.query=f(f({},e.query),{queryFilter:!0}),this.ngOnInit()},e.ctorParameters=function(){return[{type:l.b},{type:s.a},{type:c.b},{type:r.b}]},e=h([Object(o.n)({selector:"app-list",template:m(n("tiBi")).default,styles:[m(n("szAk")).default]}),g("design:paramtypes",[l.b,s.a,c.b,r.b])],e)}(),y=n("CD38"),v=n("k46B"),O=n("wgY5"),S=function(e,t,n,o){var a,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(r<3?a(i):r>3?a(t,n,i):a(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},k=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},x=function(e){return e&&e.__esModule?e:{default:e}},w=function(){function e(e,t,n,o,a){this.activeSnapShot=e,this.tendoo=t,this.snackbar=n,this.router=o,this.loadsService=a,this.mode="create"}return e.prototype.ngOnInit=function(){var e=this;this.activeSnapShot.paramMap.subscribe((function(t){t.get("id")&&(e.mode="edit",e.id=+t.get("id"))})),this.tendoo.forms.getPublicForm("brookr.loads",this.id||void 0).subscribe((function(t){t.sections.forEach((function(e){e.fields.forEach((function(e){"ng-datetime"===e.type&&(e.value=new Date(e.value))}))})),e.form=y.a.buildForm(t),e.form.sections.forEach((function(e){"main"===e.namespace&&(e.render=!1)})),e.form=t}))},e.prototype.handleSubmit=function(e){var t=this;if(this.form.sections.forEach((function(e){return y.a.touchAllFields(e.formGroup)})),this.form.formGroup.invalid)return this.snackbar.open("Unable to proceed the form is not valid.","OK",{duration:3e3});this.form.sections.forEach((function(e){return y.a.deactivateFields(e.fields)}));var n=new FormData;this.form.sections.forEach((function(e){e.fields.forEach((function(t){["ng-datetime"].includes(t.type)?n.append(e.namespace+"--"+t.name,O(t.control.value).format("YYYY-MM-DD HH:mm")):n.append(e.namespace+"--"+t.name,t.control.value)}))})),console.log(n),this.loadsService.registerLoads(n,this.id).subscribe((function(e){t.snackbar.open(e.message,"OK",{duration:3e3}),t.router.navigateByUrl("/dashboard/loads")}),(function(e){t.snackbar.open(e.error.message||e.message||"An unexpected error has occured.","OK",{duration:6e3}),t.form.sections.forEach((function(e){return y.a.enableFields(e.fields)}))}))},e.ctorParameters=function(){return[{type:r.a},{type:l.b},{type:s.a},{type:r.b},{type:v.a}]},e=S([Object(o.n)({selector:"app-manage",template:x(n("xloT")).default,styles:[x(n("/qA+")).default]}),k("design:paramtypes",[r.a,l.b,s.a,r.b,v.a])],e)}(),I=function(e,t,n,o){var a,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(r<3?a(i):r>3?a(t,n,i):a(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},P=[{path:"",component:b},{path:"create",component:w},{path:"edit/:id",component:w}],L=function(){function e(){}return e=I([Object(o.M)({imports:[r.c.forChild(P)],exports:[r.c]})],e)}(),R=n("428I"),C=function(e,t,n,o){var a,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(r<3?a(i):r>3?a(t,n,i):a(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},j=function(){function e(){}return e=C([Object(o.M)({declarations:[b,w],imports:[a.c,L,R.a]})],e)}()},szAk:function(e,t,n){"use strict";n.r(t),t.default=""},tiBi:function(e,t,n){"use strict";n.r(t),t.default='<app-layout>\r\n    <div class="mb-4 text-gray-800">\r\n        <span class="block text-2xl mb-2">Available Loads</span> \r\n        <p class="text-sm">Manage all assigned loads delivery</p>\r\n    </div>\r\n    <div class="w-full flex-auto">\r\n        \x3c!-- <cb-table \r\n            (action)="handleAction( $event )" \r\n            (sort)="handleSort( $event )" \r\n            (refresh)="handleRefresh( $event )" \r\n            (page)="handlePagineNavigation( $event )" \r\n            (search)="handleSearch( $event )"\r\n            (search-status)="handleSearchStatus( $event )"\r\n            [is-loading]="isLoading"\r\n            *ngIf="config" [crud]="config" class="w-full"></cb-table> --\x3e\r\n        <app-table \r\n            (action)="handleAction( $event )"\r\n            (refresh)="handleRefresh( $event )"  \r\n            (search)="handleSearch( $event )"\r\n            (sort)="handleSort( $event )"\r\n            (search-status)="handleSearchStatus( $event )"\r\n            (query-search)="handleQuerySearch( $event )"\r\n            (close-search)="handleCloseSearch( $event )"\r\n            (pageSize)="handlePageSize( $event )"\r\n            (navigate)="handleNavigation( $event )"\r\n            *ngIf="config" \r\n            [config]="config"\r\n            [bulk]="bulkMenus"\r\n            ></app-table>\r\n        \x3c!-- <app-table (sort)="handleSort( $event )" (search)="handleSearch( $event )" [config]="config"></app-table> --\x3e\r\n    </div>   \r\n</app-layout>'},xloT:function(e,t,n){"use strict";n.r(t),t.default='<app-layout>\r\n    <div class="mb-2" *ngIf="mode === \'create\'">\r\n        <p class="text-2xl mb-2 font-serif text-gray-800">Create Load</p>\r\n        <p class="text-gray-700">Loads are assigned to drivers for delivery.</p>\r\n    </div>\r\n    <div class="mb-2" *ngIf="mode === \'edit\'">\r\n        <p class="text-2xl mb-2 font-serif text-gray-800">Edit Load</p>\r\n        <p class="text-gray-700">Loads are assigned to drivers for delivery.</p>\r\n    </div>\r\n    <form *ngIf="form" [formGroup]="form.formGroup">\r\n        <div class="mb-4" *ngFor="let field of form.sections[0].fields">\r\n            <input [formControl]="field.control" type="text" class="rounded border border-gray-400 p-2 w-full" placeholder="Load Title">\r\n            <span class="text-gray-600 my-1 text-xs block">Can automatically be generated.</span>\r\n        </div>\r\n        <app-tabs *ngIf="form" [form]="form" (submit)="handleSubmit( $event )"></app-tabs>\r\n    </form>\r\n</app-layout>'}}]);