{"version":3,"sources":["./src/app/auth/auth.component.html","./src/app/auth/logout/logout.component.html","./src/app/auth/auth-routing.module.ts","./src/app/auth/auth.component.scss","./src/app/auth/auth.component.ts","./src/app/auth/auth.module.ts","./src/app/auth/logout/logout.component.scss","./src/app/auth/logout/logout.component.ts"],"names":[],"mappings":"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","file":"auth-auth-module.js","sourcesContent":["export default \"<div id=\\\"container\\\" class=\\\"bg-gray-200 h-full flex justify-center items-center\\\">\\r\\n    <div class=\\\"p-2 w-full sm:w-2/3 md:w-1/2 lg:w-2/6 xl:1/4 flex flex-col items-center\\\">\\r\\n        <span class=\\\"brookr-font block text-6xl my-3 text-gray-800\\\">\\r\\n            <img class=\\\"w-64\\\" [src]=\\\"urlPrefix + '/assets/images/smm-icon.png'\\\" alt=\\\"\\\">\\r\\n        </span>\\r\\n        <div class=\\\"flex justify-center my-10\\\" *ngIf=\\\"! loaded\\\">\\r\\n            <mat-progress-spinner diameter=\\\"60\\\" mode=\\\"indeterminate\\\"></mat-progress-spinner>\\r\\n        </div>\\r\\n        <div id=\\\"login-card\\\" *ngIf=\\\"loaded\\\" class=\\\"rounded-lg w-full shadow bg-white p-4 mt-2 mb-10\\\">\\r\\n            <form [formGroup]=\\\"form\\\">\\r\\n                <cb-field [group]=\\\"form\\\" [field]=\\\"field\\\" *ngFor=\\\"let field of fields\\\"></cb-field>\\r\\n                <div class=\\\"button-container py-3 flex justify-end\\\">\\r\\n                    <button type=\\\"submit\\\" [disabled]=\\\"isLoggingIn\\\" (click)=\\\"login()\\\" [ngClass]=\\\"{\\r\\n                        'bg-pink-700 text-white' : ! isLoggingIn,\\r\\n                        'bg-pink-500 text-gray-100' : isLoggingIn\\r\\n                    }\\\" class=\\\"rounded shadow px-3 py-2 bg-pink-700 text-white\\\">Login</button>\\r\\n                </div>\\r\\n                <div class=\\\"button-container py-3 flex justify-center\\\">\\r\\n                    <a href=\\\"#\\\" class=\\\"hover:underline text-blue-600 text-sm\\\">Password Lost ?</a>\\r\\n                </div>\\r\\n            </form>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\";","export default \"\";","import {\r\n  NgModule\r\n} from '@angular/core';\r\nimport {\r\n  Routes,\r\n  RouterModule\r\n} from '@angular/router';\r\n\r\nimport {\r\n  AuthComponent\r\n} from './auth.component';\r\nimport { LogoutComponent } from './logout/logout.component';\r\n\r\nconst routes: Routes = [{\r\n  path: 'login',\r\n  component: AuthComponent\r\n}, {\r\n  path: 'logout',\r\n  component: LogoutComponent\r\n}];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class AuthRoutingModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9qZWN0cy9icm9va3ItdWkvc3JjL2FwcC9hdXRoL2F1dGguY29tcG9uZW50LnNjc3MifQ== */\";","import { Component, OnInit, isDevMode } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { TendooService } from '@cloud-breeze/services';\r\nimport { ValidationGenerator } from \"@cloud-breeze/utilities\";\r\nimport { Field } from '@cloud-breeze/core';\r\nimport { environment } from '../../environments/environment';\r\nimport * as moment from \"moment\";\r\n\r\n@Component({\r\n  selector: 'app-auth',\r\n  templateUrl: './auth.component.html',\r\n  styleUrls: ['./auth.component.scss']\r\n})\r\nexport class AuthComponent implements OnInit {\r\n  fields: Field[];\r\n  form: FormGroup;\r\n  loaded        = false;\r\n  isLoggingIn   = false;\r\n  urlPrefix   = ! isDevMode() ? '/modules/brookr/brookr' : '';\r\n\r\n  constructor(\r\n    private tendoo: TendooService,\r\n    private snackbar: MatSnackBar,\r\n    private router: Router,\r\n    private activatedRoute: ActivatedRoute \r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.tendoo.fields.getPublicFields( 'brookr.login' ).subscribe( ( fields: Field[] ) => {\r\n      const result  = ValidationGenerator.buildFormGroup( fields );\r\n      this.form     = result.formGroup;\r\n      this.fields   = result.fields;\r\n      this.loaded   = true;\r\n      // debug\r\n      if ( ! environment.production ) {\r\n        // this.form.get( 'username' ).setValue( 'paolino' );\r\n        this.form.get( 'username' ).setValue( 'admin' );\r\n        this.form.get( 'password' ).setValue( 'sanches' );\r\n        // this.login();\r\n      }\r\n    }, ( result ) => {\r\n      this.snackbar.open( result[ 'error' ][ 'message' ] || result.message || 'An unexpected error has occured', 'TRY AGAIN' )\r\n        .afterDismissed()\r\n        .subscribe( action => {\r\n          if ( action.dismissedByAction ) {\r\n            this.ngOnInit();\r\n          }\r\n      })\r\n    });\r\n  }\r\n\r\n  login() {\r\n    ValidationGenerator.touchAllFields( this.form );\r\n\r\n    if ( this.form.invalid ) {\r\n      return this.snackbar.open( 'Unable to proceed the form is not valid.', 'OK', { duration: 3000 });\r\n    }\r\n\r\n    this.isLoggingIn  = true;\r\n    ValidationGenerator.deactivateFields( this.fields );\r\n    \r\n    this.tendoo.auth.login( this.form.value ).subscribe( result => {\r\n\r\n      this.activatedRoute.queryParamMap.subscribe( param => {\r\n\r\n        this.tendoo.auth.setCredentials( result[ 'user' ], result[ 'token' ]);\r\n        const now   =   moment.now();\r\n        this.tendoo.cookie.set( 'auth.user', result[ 'token' ], moment( now ).add( 7, 'days' ).toDate(), '/' );\r\n\r\n        this.tendoo.get( `${this.tendoo.baseUrl}brookr/profile/avatar` ).subscribe( avatar => {\r\n          const path = param.get( 'redirect' ) || ( result[ 'user' ].role.namespace === 'brookr.drivers' ? '/dashboard/drivers/loads' : '/dashboard' );\r\n\r\n          result[ 'user' ].avatar   = avatar[ 'link' ] || null;\r\n\r\n          this.snackbar.open( result[ 'message' ], null, { duration: 3000 });\r\n          this.router.navigateByUrl( path );\r\n        })\r\n\r\n      })\r\n    }, ( result ) => {\r\n      this.isLoggingIn  = false;\r\n      ValidationGenerator.enableFields( this.fields );\r\n      this.snackbar.open( result[ 'error' ][ 'message' ] || 'An unexpected error has occored', 'OK', { duration: 5000 });\r\n    });\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { AuthRoutingModule } from './auth-routing.module';\r\nimport { AuthComponent } from './auth.component';\r\nimport { DeclarationsModule } from '../declarations/declarations.module';\nimport { LogoutComponent } from './logout/logout.component';\r\n\r\n\r\n@NgModule({\r\n  declarations: [AuthComponent, LogoutComponent],\r\n  imports: [\r\n    CommonModule,\r\n    AuthRoutingModule,\r\n    DeclarationsModule\r\n  ]\r\n})\r\nexport class AuthModule { }\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9qZWN0cy9icm9va3ItdWkvc3JjL2FwcC9hdXRoL2xvZ291dC9sb2dvdXQuY29tcG9uZW50LnNjc3MifQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { TendooService } from '@cloud-breeze/services';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-logout',\n  templateUrl: './logout.component.html',\n  styleUrls: ['./logout.component.scss']\n})\nexport class LogoutComponent implements OnInit {\n\n  constructor(\n    private tendoo: TendooService,\n    private snackbar: MatSnackBar,\n    private router: Router\n  ) { }\n\n  ngOnInit(): void {\n    this.tendoo.auth.logout().subscribe( result => {\n      this.tendoo.cookie.delete( 'auth.user' );\n      this.snackbar.open( result[ 'message' ], 'OK', { duration: 3000 });\n      this.router.navigateByUrl( '/auth/login' );\n    })\n  }\n\n}\n"],"sourceRoot":"webpack:///"}