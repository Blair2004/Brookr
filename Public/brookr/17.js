(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{pGcJ:function(e,o,t){"use strict";t.r(o);var n=t("8AiQ"),r=t("5/c3"),i=t("AFHi"),c=t("BLjT"),s=t("CD38"),a=t("1C3z"),d=t("z35L"),u=t("IugH"),f=t("2pW/"),l=t("ZSGP");function p(e,o){if(1&e&&a.Yb(0,"cb-field",9),2&e){var t=o.$implicit,n=a.pc(2);a.vc("field",t)("group",n.form.sections[0].formGroup)}}function h(e,o){if(1&e&&(a.dc(0,"form",7),a.Mc(1,p,1,2,"cb-field",8),a.cc()),2&e){var t=a.pc();a.vc("formGroup",t.form.formGroup),a.Kb(1),a.vc("ngForOf",t.form.sections[0].fields)}}var b=function(){function e(e,o,t,n,r){this.tendoo=e,this.store=o,this.snackbar=t,this.data=n,this.dialog=r,this.orderId=n.id}return e.prototype.ngOnInit=function(){var e=this;setTimeout((function(){e.tendoo.forms.getPublicForm("broork.loads-drivers",e.orderId).subscribe((function(o){e.form=s.a.buildForm(o)}),(function(o){e.snackbar.open(o.error.message||o.message,"OK",{duration:3e3})}))}),0)},e.prototype.closeDialog=function(){this.dialog.getDialogById("assign-load").close()},e.prototype.saveDriverDetails=function(){var e=this;if(this.form.sections.forEach((function(e){return s.a.touchAllFields(e.formGroup)})),this.form.formGroup.invalid)return this.snackbar.open("Unable to proceed the form is not valid.","OK",{duration:3e3});this.form.sections.forEach((function(e){return s.a.deactivateFields(e.fields)})),this.tendoo.put(this.tendoo.baseUrl+"brookr/loads/update-driver/"+this.orderId,this.form.formGroup.value).subscribe((function(o){e.snackbar.open(o.message,"OK",{duration:3e3}),e.dialog.getDialogById("assign-load").close()}),(function(o){e.form.sections.forEach((function(e){return s.a.enableFields(e.fields)})),e.snackbar.open(o.error.message||o.message,"OK",{duration:5e3})}))},e.\u0275fac=function(o){return new(o||e)(a.Xb(d.b),a.Xb(u.a),a.Xb(f.a),a.Xb(c.a),a.Xb(c.b))},e.\u0275cmp=a.Rb({type:e,selectors:[["app-load-assignation"]],decls:10,vars:1,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"box-title","flex","flex-shrink-0","justify-center","py-4","border-b","border-gray-400","items-center","text-2xl"],[1,"flex","flex-auto","overflow-y-auto","p-4"],["class","field container",3,"formGroup",4,"ngIf"],[1,"box-title","flex","flex-shrink-0","justify-end","border-t","border-gray-400","items-center","text-xl","p-2"],[1,"ml-2","bg-red-400","text-white","rounded","border","border-red-600","px-3","py-2",3,"click"],[1,"ml-2","rounded","border","border-gray-400","px-3","py-2",3,"click"],[1,"field","container",3,"formGroup"],[3,"field","group",4,"ngFor","ngForOf"],[3,"field","group"]],template:function(e,o){1&e&&(a.dc(0,"div",0),a.dc(1,"div",1),a.Nc(2,"Assign Driver"),a.cc(),a.dc(3,"div",2),a.Mc(4,h,2,2,"form",3),a.cc(),a.dc(5,"div",4),a.dc(6,"button",5),a.lc("click",(function(){return o.closeDialog()})),a.Nc(7,"Cancel"),a.cc(),a.dc(8,"button",6),a.lc("click",(function(){return o.saveDriverDetails()})),a.Nc(9,"Save"),a.cc(),a.cc(),a.cc()),2&e&&(a.Kb(4),a.vc("ngIf",o.form))},directives:[n.l,l.t,l.n,l.h,n.k,i.d],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]}),e}();function m(e,o){if(1&e&&a.Yb(0,"cb-field",9),2&e){var t=o.$implicit,n=a.pc(2);a.vc("field",t)("group",n.form.sections[0].formGroup)}}function g(e,o){if(1&e&&(a.dc(0,"form",7),a.Mc(1,m,1,2,"cb-field",8),a.cc()),2&e){var t=a.pc();a.vc("formGroup",t.form.formGroup),a.Kb(1),a.vc("ngForOf",t.form.sections[0].fields)}}var v=function(){function e(e,o,t,n){this.tendoo=e,this.menu=o,this.snackbar=t,this.dialogRef=n,this.orderId=this.menu.id}return e.prototype.ngOnInit=function(){var e=this;setTimeout((function(){e.tendoo.forms.getPublicForm("broork.loads-status",e.orderId).subscribe((function(o){e.form=s.a.buildForm(o)}),(function(o){e.snackbar.open(o.error.message||o.message,"OK",{duration:3e3})}))}),0)},e.prototype.saveStatus=function(){var e=this;if(this.form.sections.forEach((function(e){return s.a.touchAllFields(e.formGroup)})),this.form.formGroup.invalid)return this.snackbar.open("Unable to proceed the form is not valid.","OK",{duration:6e3});this.form.sections.forEach((function(e){return s.a.deactivateFields(e.fields)})),this.tendoo.put(this.tendoo.baseUrl+"brookr/loads/update-status/"+this.orderId,this.form.formGroup.value).subscribe((function(o){e.snackbar.open(o.message,"OK",{duration:3e3}),e.dialogRef.close()}),(function(o){e.snackbar.open(o.error.message,"OK",{duration:6e3}),e.form.sections.forEach((function(e){return s.a.enableFields(e.fields)}))}))},e.prototype.closeDialog=function(){this.dialogRef.close()},e.\u0275fac=function(o){return new(o||e)(a.Xb(d.b),a.Xb(c.a),a.Xb(f.a),a.Xb(c.d))},e.\u0275cmp=a.Rb({type:e,selectors:[["app-load-status"]],decls:10,vars:1,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"box-title","flex","flex-shrink-0","justify-center","py-4","border-b","border-gray-400","items-center","text-2xl"],[1,"flex","flex-auto","overflow-y-auto","p-4"],["class","field container",3,"formGroup",4,"ngIf"],[1,"box-title","flex","flex-shrink-0","justify-end","border-t","border-gray-400","items-center","text-xl","p-2"],[1,"ml-2","bg-red-400","text-white","rounded","border","border-red-600","px-3","py-2",3,"click"],[1,"ml-2","rounded","border","border-gray-400","px-3","py-2",3,"click"],[1,"field","container",3,"formGroup"],[3,"field","group",4,"ngFor","ngForOf"],[3,"field","group"]],template:function(e,o){1&e&&(a.dc(0,"div",0),a.dc(1,"div",1),a.Nc(2,"Change Status"),a.cc(),a.dc(3,"div",2),a.Mc(4,g,2,2,"form",3),a.cc(),a.dc(5,"div",4),a.dc(6,"button",5),a.lc("click",(function(){return o.closeDialog()})),a.Nc(7,"Cancel"),a.cc(),a.dc(8,"button",6),a.lc("click",(function(){return o.saveStatus()})),a.Nc(9,"Save"),a.cc(),a.cc(),a.cc()),2&e&&(a.Kb(4),a.vc("ngIf",o.form))},directives:[n.l,l.t,l.n,l.h,n.k,i.d],styles:[""]}),e}(),y=t("ryqd"),k=t("4Snu"),x=function(){return(x=Object.assign||function(e){for(var o,t=1,n=arguments.length;t<n;t++)for(var r in o=arguments[t])Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e}).apply(this,arguments)};function O(e,o){if(1&e){var t=a.ec();a.dc(0,"app-table",5),a.lc("action",(function(e){return a.Gc(t),a.pc().handleAction(e)}))("refresh",(function(e){return a.Gc(t),a.pc().handleRefresh(e)}))("search",(function(e){return a.Gc(t),a.pc().handleSearch(e)}))("sort",(function(e){return a.Gc(t),a.pc().handleSort(e)}))("search-status",(function(e){return a.Gc(t),a.pc().handleSearchStatus(e)})),a.cc()}if(2&e){var n=a.pc();a.vc("config",n.config)("bulk",n.bulkMenus)}}var I=function(){function e(e,o,t,n){this.tendoo=e,this.snackbar=o,this.dialog=t,this.router=n,this.isLoading=!1,this.sort={},this.search={},this.page={},this.bulkMenus=[],this.perPage={per_page:10}}return e.prototype.loadConfiguration=function(){var e=this;this.tendoo.crud.getConfig("brookr.loads",x(x(x(x({},this.page),this.search),this.sort),this.perPage)).subscribe((function(o){e.config=o}))},e.prototype.ngOnInit=function(){var e=this;this.loadConfiguration(),this.bulkMenus=[{label:"Delete Selected",onClick:function(o){if(0===o.length)return e.snackbar.open("Please select at least one element.","OK",{duration:3e3});e.dialog.open(i.c,{id:"confirm-dialog",data:{title:"Confirm your action",message:"Would you like to delete the selected loads.",buttons:[{namespace:"yes",label:"Yes",onClick:function(){e.dialog.getDialogById("confirm-dialog").close(),e.tendoo.crud.deleteBulkEntries("brookr.loads",o.map((function(e){return e.id}))).subscribe((function(o){e.snackbar.open(o.message,"OK",{duration:3e3}),e.loadConfiguration()}),(function(o){e.snackbar.open(o.error.message||o.message,"OK",{duration:3e3})}))}},{namespace:"no",label:"No",onClick:function(){e.dialog.getDialogById("confirm-dialog").close()}}]}})}}]},e.prototype.handleAction=function(e){var o=this;"DELETE"===e.menu.type?this.tendoo.crud.delete(e.menu.url.replace("{id}",e.row.id)).subscribe((function(t){o.snackbar.open(t.message,"OK",{duration:3e3}),o.ngOnInit(),o.dialog.getDialogById(e.menu.namespace).close()}),(function(t){o.snackbar.open(t.error.message||"An unexpected error occured","OK",{duration:5e3}),o.dialog.getDialogById(e.menu.namespace).close()})):"GOTO"===e.menu.type?this.router.navigateByUrl(e.menu.url.replace("{id}",e.row.id)):"OPEN"===e.menu.type&&"open.assign_driver"===e.menu.namespace?this.openLoadAssignation(e.menu):"OPEN"===e.menu.type&&"open.change_status"===e.menu.namespace&&this.openLoadChangeStatus(e.menu)},e.prototype.openLoadChangeStatus=function(e){var o=this;console.log(e),this.dialog.open(v,{id:"load-status",data:e,height:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"80%":"400px",width:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"70%":"500px"}).afterClosed().subscribe((function(e){o.ngOnInit(),console.log(e)}))},e.prototype.openLoadAssignation=function(e){var o=this;this.dialog.open(b,{id:"assign-load",data:e,height:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"80%":"400px",width:[this.tendoo.responsive.isSM(),this.tendoo.responsive.isXS()].includes(!0)?"70%":"500px"}).afterClosed().subscribe((function(e){o.ngOnInit(),console.log(e)}))},e.prototype.handleSort=function(e){this.sort=e,this.ngOnInit()},e.prototype.handleSearch=function(e){this.search={search:e},this.ngOnInit()},e.prototype.handleSearchStatus=function(e){!1===e&&(this.search={},this.ngOnInit())},e.prototype.handleRefresh=function(e){this.ngOnInit()},e.prototype.handlePagineNavigation=function(e){this.perPage={per_page:e.pageSize},this.page={page:e.pageIndex+1},this.ngOnInit()},e.\u0275fac=function(o){return new(o||e)(a.Xb(d.b),a.Xb(f.a),a.Xb(c.b),a.Xb(r.b))},e.\u0275cmp=a.Rb({type:e,selectors:[["app-list"]],decls:8,vars:1,consts:[[1,"mb-4","text-gray-800"],[1,"block","text-2xl","mb-2"],[1,"text-sm"],[1,"w-full","flex-auto"],[3,"config","bulk","action","refresh","search","sort","search-status",4,"ngIf"],[3,"config","bulk","action","refresh","search","sort","search-status"]],template:function(e,o){1&e&&(a.dc(0,"app-layout"),a.dc(1,"div",0),a.dc(2,"span",1),a.Nc(3,"Available Loads"),a.cc(),a.dc(4,"p",2),a.Nc(5,"Manage all assigned loads delivery"),a.cc(),a.cc(),a.dc(6,"div",3),a.Mc(7,O,1,2,"app-table",4),a.cc(),a.cc()),2&e&&(a.Kb(7),a.vc("ngIf",o.config))},directives:[y.a,n.l,k.a],styles:[""]}),e}(),S=t("k46B"),G=t("eTQ6");function w(e,o){1&e&&(a.dc(0,"div",2),a.dc(1,"p",3),a.Nc(2,"Create Load"),a.cc(),a.dc(3,"p",4),a.Nc(4,"Loads are assigned to drivers for delivery."),a.cc(),a.cc())}function K(e,o){1&e&&(a.dc(0,"div",2),a.dc(1,"p",3),a.Nc(2,"Edit Load"),a.cc(),a.dc(3,"p",4),a.Nc(4,"Loads are assigned to drivers for delivery."),a.cc(),a.cc())}function F(e,o){if(1&e&&(a.dc(0,"div",8),a.Yb(1,"input",9),a.dc(2,"span",10),a.Nc(3,"Can automatically be generated."),a.cc(),a.cc()),2&e){var t=o.$implicit;a.Kb(1),a.vc("formControl",t.control)}}function C(e,o){if(1&e){var t=a.ec();a.dc(0,"app-tabs",11),a.lc("submit",(function(e){return a.Gc(t),a.pc(2).handleSubmit(e)})),a.cc()}if(2&e){var n=a.pc(2);a.vc("form",n.form)}}function X(e,o){if(1&e&&(a.dc(0,"form",5),a.Mc(1,F,4,1,"div",6),a.Mc(2,C,1,1,"app-tabs",7),a.cc()),2&e){var t=a.pc();a.vc("formGroup",t.form.formGroup),a.Kb(1),a.vc("ngForOf",t.form.sections[0].fields),a.Kb(1),a.vc("ngIf",t.form)}}var M=function(){function e(e,o,t,n,r){this.activeSnapShot=e,this.tendoo=o,this.snackbar=t,this.router=n,this.loadsService=r,this.mode="create"}return e.prototype.ngOnInit=function(){var e=this;this.activeSnapShot.paramMap.subscribe((function(o){o.get("id")&&(e.mode="edit",e.id=+o.get("id"))})),this.tendoo.forms.getPublicForm("brookr.loads",this.id||void 0).subscribe((function(o){o.sections.forEach((function(e){e.fields.forEach((function(e){"ng-datetime"===e.type&&(e.value=new Date(e.value))}))})),e.form=s.a.buildForm(o),e.form.sections.forEach((function(e){"main"===e.namespace&&(e.render=!1)})),e.form=o}))},e.prototype.handleSubmit=function(e){var o=this;if(this.form.sections.forEach((function(e){return s.a.touchAllFields(e.formGroup)})),this.form.formGroup.invalid)return this.snackbar.open("Unable to proceed the form is not valid.","OK",{duration:3e3});this.form.sections.forEach((function(e){return s.a.deactivateFields(e.fields)})),console.log(this.form.formGroup.value),this.loadsService.registerLoads(this.form.formGroup.value,this.id).subscribe((function(e){o.snackbar.open(e.message,"OK",{duration:3e3}),o.router.navigateByUrl("/dashboard/loads")}),(function(e){o.snackbar.open(e.error.message||e.message||"An unexpected error has occured.","OK",{duration:6e3}),o.form.sections.forEach((function(e){return s.a.enableFields(e.fields)}))}))},e.\u0275fac=function(o){return new(o||e)(a.Xb(r.a),a.Xb(d.b),a.Xb(f.a),a.Xb(r.b),a.Xb(S.a))},e.\u0275cmp=a.Rb({type:e,selectors:[["app-manage"]],decls:4,vars:3,consts:[["class","mb-2",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"mb-2"],[1,"text-2xl","mb-2","font-serif","text-gray-800"],[1,"text-gray-700"],[3,"formGroup"],["class","mb-4",4,"ngFor","ngForOf"],[3,"form","submit",4,"ngIf"],[1,"mb-4"],["type","text","placeholder","Load Title",1,"rounded","border","border-gray-400","p-2","w-full",3,"formControl"],[1,"text-gray-600","my-1","text-xs","block"],[3,"form","submit"]],template:function(e,o){1&e&&(a.dc(0,"app-layout"),a.Mc(1,w,5,0,"div",0),a.Mc(2,K,5,0,"div",0),a.Mc(3,X,3,3,"form",1),a.cc()),2&e&&(a.Kb(1),a.vc("ngIf","create"===o.mode),a.Kb(1),a.vc("ngIf","edit"===o.mode),a.Kb(1),a.vc("ngIf",o.form))},directives:[y.a,n.l,l.t,l.n,l.h,n.k,l.c,l.m,l.e,G.a],styles:[""]}),e}(),D=[{path:"",component:I},{path:"create",component:M},{path:"edit/:id",component:M}],E=function(){function e(){}return e.\u0275mod=a.Vb({type:e}),e.\u0275inj=a.Ub({factory:function(o){return new(o||e)},imports:[[r.e.forChild(D)],r.e]}),e}(),N=t("428I");t.d(o,"LoadsModule",(function(){return L}));var L=function(){function e(){}return e.\u0275mod=a.Vb({type:e}),e.\u0275inj=a.Ub({factory:function(o){return new(o||e)},imports:[[n.c,E,N.a]]}),e}()}}]);