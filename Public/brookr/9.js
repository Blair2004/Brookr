(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{Go0l:function(e,t,n){"use strict";n.r(t),t.default='<app-layout>\r\n    <div class="mb-4 text-gray-800">\r\n        <span class="block text-2xl mb-2">Drivers</span> \r\n        <p class="text-sm">List of all created drivers</p>\r\n    </div>\r\n    <div class="flex w-full">\r\n        <cb-table \r\n            (action)="handleAction( $event )" \r\n            (sort)="handleSort( $event )" \r\n            (refresh)="handleRefresh( $event )" \r\n            (page)="handlePagineNavigation( $event )" \r\n            (search)="handleSearch( $event )"\r\n            [is-loading]="isLoading"\r\n            *ngIf="config" [crud]="config" class="w-full"></cb-table>\r\n        \x3c!-- <app-table (sort)="handleSort( $event )" (search)="handleSearch( $event )" [config]="config"></app-table> --\x3e\r\n    </div>   \r\n</app-layout>'},IeHZ:function(e,t,n){"use strict";n.r(t),t.default=""},KnLz:function(e,t,n){"use strict";n.r(t),t.default=""},LF4N:function(e,t,n){"use strict";n.r(t),t.default='<app-layout>\n    <div class="mb-4 text-gray-800">\n        <span class="block text-2xl mb-2">Loads</span> \n        <p class="text-sm">list all loads available for the drivers.</p>\n    </div>\n    <div class="flex w-full flex-col">\n        <div class="tab tab-container">\n            <div class="tabs-header flex" style="margin-bottom: -2px;">\n                <div (click)="setTabActive( section )" [ngClass]="{\n                    \'bg-gray-100\' : section.active,\n                    \'bg-gray-300\' : ! section.active\n                }" *ngFor="let section of sections" class="tab px-4 py-2 border-2 border-b-0 rounded-t-lg cursor-pointer flex items-center justify center">\n                    {{ section.title }} \n                </div>\n            </div>\n        </div>\n        <div class="bg-gray-100 border-2">\n            <app-table \n                (action)="handleAction( $event )"\n                *ngIf="config" \n                (refresh)="handleRefresh( $event )"\n                (sort)="handleSort( $event )" \n                (search)="handleSearch( $event )" \n                [config]="config"></app-table>\n        </div>\n    </div>   \n</app-layout>'},a4nD:function(e,t,n){"use strict";n.r(t),t.default='<app-layout>\r\n    <div class="mb-2">\r\n        <p *ngIf="mode === \'create\'" class="text-2xl mb-2 font-serif text-gray-800">Creating a driver</p>\r\n        <p *ngIf="mode === \'edit\'" class="text-2xl mb-2">Editing a driver</p>\r\n        <p class="text-gray-700">Drivers can pickup and deliver loads which are assigned to them or not yet assigned.</p>\r\n    </div>\r\n    <app-tabs *ngIf="form" [form]="form" (submit)="handleSubmit( $event )"></app-tabs>\r\n</app-layout>'},iQDh:function(e,t,n){"use strict";n.r(t),n.d(t,"DriversModule",(function(){return M}));var o=n("LoAr"),r=n("WT9V"),i=n("981U"),a=n("qptw"),s=n("8YcR"),c=n("z35L"),d=n("0BcZ"),l=function(){return(l=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},p=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e){return e&&e.__esModule?e:{default:e}},h=function(){function e(e,t,n,o){this.tendoo=e,this.snackbar=t,this.dialog=n,this.router=o,this.isLoading=!1,this.sort={},this.search={},this.page={},this.perPage={per_page:20}}return e.prototype.ngOnInit=function(){var e=this;this.tendoo.crud.getConfig("brookr.drivers",l(l(l(l({},this.page),this.search),this.sort),this.perPage)).subscribe((function(t){e.config=t}))},e.prototype.handleAction=function(e){var t=this;"DELETE"===e.menu.type?this.tendoo.crud.delete(e.menu.url.replace("{id}",e.row.id)).subscribe((function(n){t.snackbar.open(n.message,"OK",{duration:3e3}),t.ngOnInit(),t.dialog.getDialogById(e.menu.namespace).close()}),(function(n){t.snackbar.open(n.error.message||"An unexpected error occured","OK",{duration:5e3}),t.dialog.getDialogById(e.menu.namespace).close()})):"GOTO"===e.menu.type?this.router.navigateByUrl(e.menu.url.replace("{id}",e.row.id)):"open.payment"===e.menu.namespace&&this.dialog.open(d.a,{id:"driver-payment-popup",data:{resource:e.row,formNamespace:"brookr.advance-payment.drivers",postNamespace:"brookr/drivers/payments/"},width:[this.tendoo.responsive.isLG(),this.tendoo.responsive.isXL()].includes(!0)?"600px":"80%",height:[this.tendoo.responsive.isLG(),this.tendoo.responsive.isXL()].includes(!0)?"600px":"80%"})},e.prototype.handleSort=function(e){this.sort=e,this.ngOnInit()},e.prototype.handleSearch=function(e){this.search={search:e},this.ngOnInit()},e.prototype.handleRefresh=function(e){this.ngOnInit()},e.prototype.handlePagineNavigation=function(e){this.perPage={per_page:e.pageSize},this.page={page:e.pageIndex+1},this.ngOnInit()},e.ctorParameters=function(){return[{type:c.b},{type:a.a},{type:s.b},{type:i.b}]},e=p([Object(o.n)({selector:"app-list",template:f(n("Go0l")).default,styles:[f(n("IeHZ")).default]}),u("design:paramtypes",[c.b,a.a,s.b,i.b])],e)}(),b=n("GiBk"),g=n("CD38"),v=n("PTmb"),y=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},m=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},O=function(e){return e&&e.__esModule?e:{default:e}},k=function(){function e(e,t,n,o,r,i){this.routeSnapshot=e,this.tendoo=t,this.client=n,this.driversService=o,this.snackbar=r,this.router=i,this.mode="create",this.id=""}return e.prototype.ngOnInit=function(){var e=this;this.routeSnapshot.paramMap.subscribe((function(t){t.get("id")&&(e.mode="edit",e.id=t.get("id")),e.generateForm()}))},e.prototype.generateForm=function(){var e=this;this.tendoo.forms.getPublicForm("brookr.drivers",+this.id>0?+this.id:void 0).subscribe((function(t){e.form=t}))},e.prototype.selectThis=function(e){this.form.sections.forEach((function(e){return e.active=!1})),e.active=!0},e.prototype.handleSubmit=function(e){var t=this;if(this.form.sections.forEach((function(e){return g.a.touchAllFields(e.formGroup)})),this.form.formGroup.invalid)return this.snackbar.open("Unable to proceed, the form is invalid","OK",{duration:3e3});this.setFieldsState("disable"),this.driversService.setDriver(this.form.formGroup.value,+this.id>0?+this.id:null).subscribe((function(e){t.setFieldsState("enable"),t.snackbar.open(e.message,"OK",{duration:3e3}),t.id||t.router.navigateByUrl("/dashboard/drivers")}),(function(e){t.snackbar.open(e.error.message||e.message||"An unexpected error has occured","OK",{duration:3e3}),t.setFieldsState("enable")}))},e.prototype.setFieldsState=function(e){this.form.sections.forEach((function(t){return g.a["disabled"===e?"deactivateFields":"enableFields"](t.fields)}))},e.ctorParameters=function(){return[{type:i.a},{type:c.b},{type:b.b},{type:v.a},{type:a.a},{type:i.b}]},e=y([Object(o.n)({selector:"app-manage",template:O(n("a4nD")).default,styles:[O(n("tqi7")).default]}),m("design:paramtypes",[i.a,c.b,b.b,v.a,a.a,i.b])],e)}(),R=n("AFHi"),j=n("8G9j"),x=n("xIjb"),w=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},L=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e){return e&&e.__esModule?e:{default:e}},A=function(){function e(e,t,n){this.tendoo=e,this.snackbar=t,this.dialog=n,this.sections=[{title:"Assigned Loads",namespace:"assigned.loads",description:"Loads assigned to your account.",active:!1,crud:this.tendoo.crud.getConfig("brookr.drivers-loads.assigned")},{title:"Unassigned Loads",namespace:"unassigned.loads",description:"Pending Loads not assigned to a driver.",active:!1,crud:this.tendoo.crud.getConfig("brookr.drivers-loads.unassigned")}]}return e.prototype.ngOnInit=function(){this.setTabActive(this.sections[0])},e.prototype.setTabActive=function(e){this.sections.forEach((function(e){return e.active=!1})),e.active=!0,this.loadActiveTabConfiguration()},e.prototype.loadActiveTabConfiguration=function(){var e=this;this.active.crud.subscribe((function(t){e.config=t}),(function(t){e.config=void 0,e.snackbar.open(t.error.message||t.error,"OK",{duration:3e3})}))},Object.defineProperty(e.prototype,"active",{get:function(){return this.sections.filter((function(e){return e.active}))[0]},enumerable:!0,configurable:!0}),e.prototype.handleRefresh=function(){this.setTabActive(this.active)},e.prototype.handleAction=function(e){var t=this;console.log(e),"handle"===e.menu.namespace?this.tendoo.get(this.tendoo.baseUrl+"brookr/drivers/is-available").subscribe((function(n){t.dialog.open(j.a,{id:"load-handle",data:{load:e.row},width:t.tendoo.responsive.isXL()||t.tendoo.responsive.isLG()||t.tendoo.responsive.isMD()?"600px":"80%",height:t.tendoo.responsive.isXL()||t.tendoo.responsive.isLG()||t.tendoo.responsive.isMD()?"400px":"80%"}).afterClosed().subscribe((function(e){t.setTabActive(t.active)}))}),(function(e){t.snackbar.open(e.error.message||e.message,"OK",{duration:6e3})})):"brookr.start-delivery"===e.menu.namespace?this.dialog.open(R.b,{id:"start-delivery",data:{title:"Start Delivery",message:"Would you like to start delivery now ?",buttons:[{namespace:"yes",label:"Yes",onClick:function(){t.dialog.getDialogById("start-delivery").close(),t.tendoo.get((t.tendoo.baseUrl+"brookr/loads/start/{id}").replace("{id}",e.row.id)).subscribe((function(e){t.setTabActive(t.active),t.snackbar.open(e.message,"OK",{duration:3e3})}))}},{namespace:"no",label:"No",onClick:function(){t.dialog.getDialogById("start-delivery").close()}}]}}):"brookr.send-delivery-document"===e.menu.namespace&&this.dialog.open(x.a,{id:"brookr.send-delivery-document",data:e.row,width:[this.tendoo.responsive.isLG(),this.tendoo.responsive.isMD(),this.tendoo.responsive.isXL()].includes(!0)?"600px":"80%",height:[this.tendoo.responsive.isLG(),this.tendoo.responsive.isMD(),this.tendoo.responsive.isXL()].includes(!0)?"600px":"80%",disableClose:!0}).afterClosed().subscribe((function(e){t.setTabActive(t.active)}))},e.ctorParameters=function(){return[{type:c.b},{type:a.a},{type:s.b}]},e=w([Object(o.n)({selector:"app-loads",template:P(n("LF4N")).default,styles:[P(n("KnLz")).default]}),L("design:paramtypes",[c.b,a.a,s.b])],e)}(),D=n("/bqT"),I=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},T=function(){function e(e,t,n){this.tendoo=e,this.snackbar=t,this.router=n}return e.prototype.canActivate=function(e,t){var n=this.tendoo.auth.getUser().role.namespace;if("brookr.driver"!==n){switch(n){case"brookr.dispatcher":case"admin":this.router.navigateByUrl("/dashboard"),this.snackbar.open("You're not allowed to see this page","OK",{duration:3e3})}return!1}return!0},e.ctorParameters=function(){return[{type:c.b},{type:a.a},{type:i.b}]},e=I([Object(o.E)({providedIn:"root"}),S("design:paramtypes",[c.b,a.a,i.b])],e)}(),C=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},F=[{path:"",canActivate:[D.a],component:h},{path:"create",canActivate:[D.a],component:k},{path:"edit/:id",canActivate:[D.a],component:k},{path:"loads",canActivate:[T],component:A}],G=function(){function e(){}return e=C([Object(o.M)({imports:[i.c.forChild(F)],exports:[i.c]})],e)}(),$=n("428I"),K=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},M=function(){function e(){}return e=K([Object(o.M)({declarations:[h,k,A],imports:[r.c,G,$.a]})],e)}()},tqi7:function(e,t,n){"use strict";n.r(t),t.default=""}}]);